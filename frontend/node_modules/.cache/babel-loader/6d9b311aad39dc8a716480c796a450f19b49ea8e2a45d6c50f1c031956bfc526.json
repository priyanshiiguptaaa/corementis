{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\rkgup\\\\OneDrive\\\\Desktop\\\\corementis\\\\frontend\\\\src\\\\components\\\\student\\\\ChatbotButton.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faComments, faRobot, faTimes, faUser, faMicrophone, faCamera, faSpinner, faTrash, faVolumeXmark, faPaperPlane, faStop, faImage, faSearch, faChartSimple } from '@fortawesome/free-solid-svg-icons';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst ChatbotButton = () => {\n  _s();\n  const [isOpen, setIsOpen] = useState(false);\n  const [messages, setMessages] = useState([]);\n  const [inputMessage, setInputMessage] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [initialized, setInitialized] = useState(false);\n  const [isListening, setIsListening] = useState(false);\n  const [speechSupported, setSpeechSupported] = useState(false);\n  const [isCameraActive, setIsCameraActive] = useState(false);\n  const [capturedImage, setCapturedImage] = useState(null);\n  const [isPlayingAudio, setIsPlayingAudio] = useState(false);\n  const [currentAudioMessage, setCurrentAudioMessage] = useState(null);\n\n  // New state variables for image generation and web scraping\n  const [isGeneratingImage, setIsGeneratingImage] = useState(false);\n  const [imagePrompt, setImagePrompt] = useState('');\n  const [generatedImage, setGeneratedImage] = useState(null);\n  const [isSearchingContent, setIsSearchingContent] = useState(false);\n  const [searchTopic, setSearchTopic] = useState('');\n  const [searchResults, setSearchResults] = useState(null);\n  const [isGeneratingGraph, setIsGeneratingGraph] = useState(false);\n  const [graphTopic, setGraphTopic] = useState('');\n  const [generatedGraph, setGeneratedGraph] = useState(null);\n  const [activeTab, setActiveTab] = useState('chat'); // 'chat', 'image', 'search', 'graph'\n\n  const messagesEndRef = useRef(null);\n  const recognitionRef = useRef(null);\n  const videoRef = useRef(null);\n  const canvasRef = useRef(null);\n  const streamRef = useRef(null);\n\n  // Generate a user ID or get from localStorage\n  const getUserId = () => {\n    let userId = localStorage.getItem('corementis_user_id');\n    if (!userId) {\n      userId = 'user_' + Math.random().toString(36).substring(2, 15);\n      localStorage.setItem('corementis_user_id', userId);\n    }\n    return userId;\n  };\n\n  // Initialize speech recognition\n  useEffect(() => {\n    // Initialize Web Speech API\n    if (window.SpeechRecognition || window.webkitSpeechRecognition) {\n      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;\n      recognitionRef.current = new SpeechRecognition();\n      recognitionRef.current.continuous = false;\n      recognitionRef.current.interimResults = false;\n      recognitionRef.current.onresult = event => {\n        const transcript = event.results[0][0].transcript;\n        setInputMessage(transcript);\n        sendMessage(transcript);\n      };\n      recognitionRef.current.onerror = event => {\n        console.error('Speech recognition error', event.error);\n        setError(`Speech recognition error: ${event.error}`);\n        setIsListening(false);\n      };\n      recognitionRef.current.onend = () => {\n        setIsListening(false);\n      };\n      setSpeechSupported(true);\n    }\n\n    // Check camera capabilities\n    if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n      console.log('Camera API is supported');\n    } else {\n      console.error('Camera API is not supported in this browser');\n      setError('Camera is not supported in your browser');\n    }\n  }, []);\n  const scrollToBottom = () => {\n    var _messagesEndRef$curre;\n    (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n      behavior: 'smooth'\n    });\n  };\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  // Initialize chatbot when first opened\n  useEffect(() => {\n    if (isOpen && !initialized) {\n      initializeChatbot();\n    }\n  }, [isOpen, initialized]);\n  const initializeChatbot = async () => {\n    try {\n      setIsLoading(true);\n      console.log('Initializing chatbot...');\n      const response = await fetch('http://localhost:5001/api/chatbot/initialize', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          user_id: getUserId(),\n          course_context: 'Computer Vision and Machine Learning'\n        })\n      });\n      if (!response.ok) {\n        throw new Error(`Server responded with status: ${response.status}`);\n      }\n      const data = await response.json();\n      if (data.success) {\n        setInitialized(true);\n        // If there's existing conversation, fetch it\n        if (data.conversation_length > 1) {\n          fetchHistory();\n        } else {\n          // Add welcome message\n          setMessages([{\n            role: 'assistant',\n            content: 'Hello! I\\'m your CoreMentis AI assistant. How can I help you with your studies today?'\n          }]);\n        }\n      } else {\n        setError('Failed to initialize chatbot: ' + data.message);\n      }\n    } catch (err) {\n      setError('Error connecting to chatbot service: ' + err.message);\n      console.error('Error initializing chatbot:', err);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const fetchHistory = async () => {\n    try {\n      const response = await fetch(`http://localhost:5001/api/chatbot/history?user_id=${getUserId()}`);\n      const data = await response.json();\n      if (data.success) {\n        setMessages(data.history);\n      }\n    } catch (err) {\n      console.error('Error fetching chat history:', err);\n    }\n  };\n  const toggleListening = () => {\n    if (!speechSupported) {\n      setError('Speech recognition is not supported in your browser.');\n      return;\n    }\n    if (isListening) {\n      recognitionRef.current.stop();\n      setIsListening(false);\n    } else {\n      setError(null);\n      recognitionRef.current.start();\n      setIsListening(true);\n    }\n  };\n  const toggleCamera = async () => {\n    console.log('Toggle camera called, current state:', isCameraActive);\n    if (isCameraActive) {\n      // Stop the camera\n      if (streamRef.current) {\n        streamRef.current.getTracks().forEach(track => track.stop());\n        streamRef.current = null;\n      }\n      setIsCameraActive(false);\n      setCapturedImage(null);\n      console.log('Camera deactivated');\n    } else {\n      try {\n        // First set camera active to render the video element\n        setIsCameraActive(true);\n\n        // Wait for the video element to be rendered\n        setTimeout(async () => {\n          try {\n            // Start the camera\n            setError(null);\n            console.log('Requesting camera access...');\n            const stream = await navigator.mediaDevices.getUserMedia({\n              video: {\n                width: {\n                  ideal: 1280\n                },\n                height: {\n                  ideal: 720\n                }\n              }\n            });\n            console.log('Camera access granted, setting up video stream');\n            streamRef.current = stream;\n            if (videoRef.current) {\n              console.log('Video ref exists, setting srcObject');\n              videoRef.current.srcObject = stream;\n              videoRef.current.onloadedmetadata = () => {\n                console.log('Video metadata loaded, dimensions:', videoRef.current.videoWidth, 'x', videoRef.current.videoHeight);\n              };\n            } else {\n              console.error('Video ref does not exist');\n              setError('Video element not found');\n              setIsCameraActive(false);\n            }\n          } catch (err) {\n            setError('Error accessing camera: ' + err.message);\n            console.error('Error accessing camera:', err);\n            setIsCameraActive(false);\n          }\n        }, 500); // Wait 500ms for the video element to be rendered\n      } catch (err) {\n        setError('Error setting up camera: ' + err.message);\n        console.error('Error setting up camera:', err);\n        setIsCameraActive(false);\n      }\n    }\n  };\n  const captureImage = () => {\n    if (!isCameraActive || !videoRef.current || !canvasRef.current) {\n      console.error('Cannot capture image: camera not active or refs not available');\n      return;\n    }\n    try {\n      const video = videoRef.current;\n      const canvas = canvasRef.current;\n      const context = canvas.getContext('2d');\n      console.log('Video dimensions:', video.videoWidth, video.videoHeight);\n\n      // Set canvas dimensions to match video\n      canvas.width = video.videoWidth || 640;\n      canvas.height = video.videoHeight || 480;\n      if (video.videoWidth === 0 || video.videoHeight === 0) {\n        console.warn('Video dimensions are zero, using fallback dimensions');\n      }\n\n      // Draw the current video frame to the canvas\n      context.drawImage(video, 0, 0, canvas.width, canvas.height);\n\n      // Get the image as a data URL\n      const imageDataUrl = canvas.toDataURL('image/jpeg', 0.9);\n      console.log('Image captured, data URL length:', imageDataUrl.length);\n      setCapturedImage(imageDataUrl);\n\n      // Stop the camera\n      if (streamRef.current) {\n        streamRef.current.getTracks().forEach(track => track.stop());\n        streamRef.current = null;\n      }\n      setIsCameraActive(false);\n    } catch (err) {\n      console.error('Error capturing image:', err);\n      setError('Error capturing image: ' + err.message);\n    }\n  };\n  const processImage = async () => {\n    if (!capturedImage) return;\n    try {\n      setIsLoading(true);\n      setError(null);\n\n      // Send the image to the backend for OCR\n      const response = await fetch('http://localhost:5001/api/chatbot/image-to-text', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          image: capturedImage\n        })\n      });\n      const data = await response.json();\n      if (data.success) {\n        // Set the extracted text in the input field\n        setInputMessage(data.text);\n\n        // Auto-send the extracted text\n        sendMessage(data.text);\n      } else {\n        setError('Failed to extract text from image: ' + data.message);\n      }\n    } catch (err) {\n      setError('Error processing image: ' + err.message);\n      console.error('Error processing image:', err);\n    } finally {\n      setIsLoading(false);\n      setCapturedImage(null);\n    }\n  };\n  const sendMessage = async voiceInput => {\n    const messageToSend = voiceInput || inputMessage.trim();\n    if (!messageToSend) return;\n    if (!voiceInput) {\n      setInputMessage('');\n    }\n\n    // Add user message to UI immediately\n    setMessages(prev => [...prev, {\n      role: 'user',\n      content: messageToSend\n    }]);\n    try {\n      setIsLoading(true);\n      const response = await fetch('http://localhost:5001/api/chatbot/message', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          user_id: getUserId(),\n          message: messageToSend\n        })\n      });\n      const data = await response.json();\n      if (data.success) {\n        // Add the response to messages with audio capability\n        setMessages(prev => [...prev, {\n          role: 'assistant',\n          content: data.response,\n          hasAudio: true,\n          // Flag to indicate this message can be converted to speech\n          audioData: null // Will store audio data once generated\n        }]);\n      } else {\n        setError('Failed to get response: ' + data.message);\n        setMessages(prev => [...prev, {\n          role: 'assistant',\n          content: 'Sorry, I encountered an error. Please try again later.'\n        }]);\n      }\n    } catch (err) {\n      setError('Error sending message: ' + err.message);\n      console.error('Error sending message:', err);\n      setMessages(prev => [...prev, {\n        role: 'assistant',\n        content: 'Sorry, I encountered an error. Please try again later.'\n      }]);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const clearConversation = async () => {\n    try {\n      const response = await fetch('http://localhost:5001/api/chatbot/clear', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          user_id: getUserId(),\n          course_context: 'Computer Vision and Machine Learning'\n        })\n      });\n      const data = await response.json();\n      if (data.success) {\n        setMessages([{\n          role: 'assistant',\n          content: 'Conversation history cleared. How can I help you today?'\n        }]);\n      } else {\n        setError('Failed to clear conversation: ' + data.message);\n      }\n    } catch (err) {\n      setError('Error clearing conversation: ' + err.message);\n      console.error('Error clearing conversation:', err);\n    }\n  };\n  const handleKeyPress = e => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      sendMessage();\n    }\n  };\n  const convertTextToSpeech = async (text, messageIndex) => {\n    try {\n      setIsPlayingAudio(true);\n      setCurrentAudioMessage(messageIndex);\n      setError(null);\n\n      // Check if we already have audio data for this message\n      if (messages[messageIndex].audioData) {\n        playAudio(messages[messageIndex].audioData);\n        return;\n      }\n\n      // First try to use the browser's built-in speech synthesis\n      if ('speechSynthesis' in window) {\n        console.log('Using browser speech synthesis');\n        speakWithBrowserTTS(text);\n        return;\n      }\n\n      // Fallback to backend TTS if browser TTS is not available\n      // Use the same origin as the current page to avoid CORS issues\n      const backendUrl = 'http://localhost:5001';\n      console.log('Using backend TTS service:', `${backendUrl}/api/chatbot/text-to-speech`);\n      const response = await fetch(`${backendUrl}/api/chatbot/text-to-speech`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          user_id: getUserId(),\n          text: text\n        }),\n        // Simplify CORS settings\n        mode: 'cors'\n      });\n      if (!response.ok) {\n        // Handle HTTP error status codes (like 503 Service Unavailable)\n        if (response.status === 503) {\n          throw new Error('Text-to-speech service is not available on this server');\n        } else {\n          throw new Error(`Server error: ${response.status}`);\n        }\n      }\n      const data = await response.json();\n      if (data.success) {\n        // Store the audio data in the message\n        const updatedMessages = [...messages];\n        updatedMessages[messageIndex].audioData = data.audio;\n        setMessages(updatedMessages);\n\n        // Play the audio\n        playAudio(data.audio);\n      } else {\n        // Handle application-level errors\n        setError('Failed to convert text to speech: ' + (data.message || 'Unknown error'));\n        setIsPlayingAudio(false);\n        setCurrentAudioMessage(null);\n      }\n    } catch (err) {\n      // Handle network errors and other exceptions\n      setError('Error: ' + (err.message || 'Failed to connect to text-to-speech service'));\n      console.error('Error converting text to speech:', err);\n      setIsPlayingAudio(false);\n      setCurrentAudioMessage(null);\n\n      // Update the message to indicate TTS is not available\n      const updatedMessages = [...messages];\n      updatedMessages[messageIndex].ttsUnavailable = true;\n      setMessages(updatedMessages);\n    }\n  };\n  const playAudio = audioBase64 => {\n    const audio = new Audio(`data:audio/wav;base64,${audioBase64}`);\n    audio.onended = () => {\n      setIsPlayingAudio(false);\n      setCurrentAudioMessage(null);\n    };\n    audio.onerror = e => {\n      console.error('Error playing audio:', e);\n      setError('Error playing audio');\n      setIsPlayingAudio(false);\n      setCurrentAudioMessage(null);\n    };\n    audio.play().catch(e => {\n      console.error('Error playing audio:', e);\n      setError('Error playing audio: ' + e.message);\n      setIsPlayingAudio(false);\n      setCurrentAudioMessage(null);\n    });\n  };\n\n  // Stop audio playback\n  const stopAudioPlayback = () => {\n    // Cancel any ongoing speech synthesis\n    if ('speechSynthesis' in window) {\n      window.speechSynthesis.cancel();\n    }\n\n    // Reset audio state\n    setIsPlayingAudio(false);\n    setCurrentAudioMessage(null);\n    console.log('Audio playback stopped');\n  };\n\n  // Generate image from text prompt\n  const generateImage = async prompt => {\n    try {\n      setIsGeneratingImage(true);\n      setError(null);\n\n      // Use the same origin as the current page to avoid CORS issues\n      const backendUrl = 'http://localhost:5001';\n      console.log('Generating image for prompt:', prompt);\n      const response = await fetch(`${backendUrl}/api/chatbot/text-to-image`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          user_id: getUserId(),\n          prompt: prompt,\n          width: 512,\n          height: 512,\n          steps: 10\n        }),\n        mode: 'cors'\n      });\n      if (!response.ok) {\n        if (response.status === 503) {\n          throw new Error('Image generation service is not available on this server');\n        } else {\n          throw new Error(`Server error: ${response.status}`);\n        }\n      }\n      const data = await response.json();\n      if (data.success) {\n        setGeneratedImage(data.image);\n\n        // Add the generated image to the conversation\n        const newMessage = {\n          role: 'assistant',\n          content: `I've generated an image based on your prompt: \"${prompt}\"`,\n          hasImage: true,\n          imageData: data.image\n        };\n        setMessages([...messages, newMessage]);\n      } else {\n        throw new Error(data.message || 'Failed to generate image');\n      }\n    } catch (err) {\n      setError('Error: ' + (err.message || 'Failed to generate image'));\n      console.error('Error generating image:', err);\n    } finally {\n      setIsGeneratingImage(false);\n      setImagePrompt('');\n    }\n  };\n\n  // Search for educational content\n  const searchEducationalContent = async topic => {\n    try {\n      setIsSearchingContent(true);\n      setError(null);\n\n      // Use the same origin as the current page to avoid CORS issues\n      const backendUrl = 'http://localhost:5001';\n      console.log('Searching educational content for topic:', topic);\n      const response = await fetch(`${backendUrl}/api/chatbot/search-content`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          user_id: getUserId(),\n          topic: topic\n        }),\n        mode: 'cors'\n      });\n      if (!response.ok) {\n        if (response.status === 503) {\n          throw new Error('Content search service is not available on this server');\n        } else {\n          throw new Error(`Server error: ${response.status}`);\n        }\n      }\n      const data = await response.json();\n      if (data.success) {\n        setSearchResults(data);\n\n        // Add the search results to the conversation\n        let content = `Here are some educational resources about \"${topic}\":\\n\\n`;\n        if (data.images && data.images.length > 0) {\n          content += `📸 ${data.images.length} relevant images found\\n`;\n        } else {\n          content += \"No relevant images found\\n\";\n        }\n        if (data.videos && data.videos.length > 0) {\n          content += `🎬 ${data.videos.length} educational videos found:\\n`;\n          data.videos.forEach((video, index) => {\n            content += `${index + 1}. ${video.title}\\n`;\n          });\n        } else {\n          content += \"No educational videos found\";\n        }\n        const newMessage = {\n          role: 'assistant',\n          content: content,\n          hasSearchResults: true,\n          searchData: data\n        };\n        setMessages([...messages, newMessage]);\n      } else {\n        throw new Error(data.message || 'Failed to search educational content');\n      }\n    } catch (err) {\n      setError('Error: ' + (err.message || 'Failed to search educational content'));\n      console.error('Error searching educational content:', err);\n    } finally {\n      setIsSearchingContent(false);\n      setSearchTopic('');\n    }\n  };\n\n  // Generate flowchart graph\n  const generateFlowchartGraph = async topic => {\n    try {\n      setIsGeneratingGraph(true);\n      setError(null);\n\n      // Use the same origin as the current page to avoid CORS issues\n      const backendUrl = 'http://localhost:5001';\n      console.log('Generating flowchart for topic:', topic);\n      const response = await fetch(`${backendUrl}/api/chatbot/generate-graph`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          user_id: getUserId(),\n          topic: topic\n        }),\n        mode: 'cors'\n      });\n      if (!response.ok) {\n        if (response.status === 503) {\n          throw new Error('Graph generation service is not available on this server');\n        } else {\n          throw new Error(`Server error: ${response.status}`);\n        }\n      }\n      const data = await response.json();\n      if (data.success) {\n        setGeneratedGraph(data);\n\n        // Add the generated graph to the conversation\n        const newMessage = {\n          role: 'assistant',\n          content: `I've created a flowchart for \"${topic}\":\\n\\n${data.text}`,\n          hasGraph: true,\n          graphData: data.image\n        };\n        setMessages([...messages, newMessage]);\n      } else {\n        throw new Error(data.message || 'Failed to generate flowchart');\n      }\n    } catch (err) {\n      setError('Error: ' + (err.message || 'Failed to generate flowchart'));\n      console.error('Error generating flowchart:', err);\n    } finally {\n      setIsGeneratingGraph(false);\n      setGraphTopic('');\n    }\n  };\n\n  // Use browser's built-in speech synthesis\n  const speakWithBrowserTTS = text => {\n    if (!('speechSynthesis' in window)) {\n      setError('Browser speech synthesis not supported');\n      setIsPlayingAudio(false);\n      setCurrentAudioMessage(null);\n      return;\n    }\n\n    // Cancel any ongoing speech\n    window.speechSynthesis.cancel();\n    const utterance = new SpeechSynthesisUtterance(text);\n\n    // Set properties\n    utterance.lang = 'en-US';\n    utterance.rate = 1.0;\n    utterance.pitch = 1.0;\n    utterance.volume = 1.0;\n\n    // Event handlers\n    utterance.onend = () => {\n      console.log('Browser TTS finished');\n      setIsPlayingAudio(false);\n      setCurrentAudioMessage(null);\n    };\n    utterance.onerror = event => {\n      console.error('Browser TTS error:', event);\n      setError('Error with speech synthesis: ' + event.error);\n      setIsPlayingAudio(false);\n      setCurrentAudioMessage(null);\n    };\n\n    // Start speaking\n    window.speechSynthesis.speak(utterance);\n    console.log('Browser TTS started');\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"fixed bottom-6 right-6 z-50\",\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => setIsOpen(!isOpen),\n      className: \"bg-intel-blue hover:bg-intel-dark-blue text-white rounded-full w-14 h-14 flex items-center justify-center shadow-lg transition-all duration-300 hover:scale-110\",\n      \"aria-label\": \"Open AI Assistant\",\n      children: /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n        icon: faComments,\n        size: \"lg\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 764,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 759,\n      columnNumber: 7\n    }, this), isOpen && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"absolute bottom-20 right-0 w-80 sm:w-96 bg-white rounded-lg shadow-xl overflow-hidden flex flex-col border border-gray-200\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-intel-blue text-white p-4 flex justify-between items-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center\",\n          children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n            icon: faRobot,\n            className: \"mr-2\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 773,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"font-medium\",\n            children: \"CoreMentis AI Assistant\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 774,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 772,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex space-x-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: clearConversation,\n            className: \"text-white hover:text-gray-200 transition-colors\",\n            title: \"Clear conversation\",\n            children: /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n              icon: faTrash\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 782,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 777,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setIsOpen(false),\n            className: \"text-white hover:text-gray-200 transition-colors\",\n            title: \"Close chatbot\",\n            children: /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n              icon: faTimes\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 789,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 784,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 776,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 771,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex-1 p-4 overflow-y-auto max-h-96 bg-gray-50\",\n        children: messages.length === 0 && !isLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-center text-gray-500 py-8\",\n          children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n            icon: faRobot,\n            size: \"2x\",\n            className: \"mb-2 text-intel-blue\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 798,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Start a conversation with the AI assistant\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 799,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 797,\n          columnNumber: 15\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-4\",\n          children: [messages.map((msg, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `flex ${msg.role === 'user' ? 'justify-end' : 'justify-start'}`,\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `max-w-3/4 rounded-lg p-3 ${msg.role === 'user' ? 'bg-intel-blue text-white rounded-br-none' : 'bg-gray-200 text-gray-800 rounded-bl-none'}`,\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center mb-1\",\n                children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n                  icon: msg.role === 'user' ? faUser : faRobot,\n                  className: \"mr-2\",\n                  size: \"xs\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 814,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-xs font-semibold\",\n                  children: msg.role === 'user' ? 'You' : 'AI Assistant'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 819,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 813,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"whitespace-pre-wrap text-sm\",\n                children: msg.content\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 823,\n                columnNumber: 23\n              }, this), msg.hasImage && msg.imageData && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mt-2\",\n                children: /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: `data:image/png;base64,${msg.imageData}`,\n                  alt: \"Generated image\",\n                  className: \"rounded-md max-w-full h-auto\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 828,\n                  columnNumber: 27\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 827,\n                columnNumber: 25\n              }, this), msg.hasSearchResults && msg.searchData && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mt-2\",\n                children: [msg.searchData.images && msg.searchData.images.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"mb-2\",\n                  children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"text-xs font-semibold mb-1\",\n                    children: \"Images:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 841,\n                    columnNumber: 31\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex flex-wrap gap-1\",\n                    children: msg.searchData.images.slice(0, 3).map((imageUrl, idx) => /*#__PURE__*/_jsxDEV(\"img\", {\n                      src: imageUrl,\n                      alt: `Search result ${idx + 1}`,\n                      className: \"w-24 h-24 object-cover rounded-md\",\n                      onError: e => {\n                        e.target.onerror = null;\n                        e.target.src = 'https://via.placeholder.com/100x100?text=Image+Error';\n                      }\n                    }, idx, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 844,\n                      columnNumber: 35\n                    }, this))\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 842,\n                    columnNumber: 31\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 840,\n                  columnNumber: 29\n                }, this), msg.searchData.videos && msg.searchData.videos.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"text-xs font-semibold mb-1\",\n                    children: \"Videos:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 861,\n                    columnNumber: 31\n                  }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n                    className: \"text-xs list-disc pl-4\",\n                    children: msg.searchData.videos.slice(0, 3).map((video, idx) => /*#__PURE__*/_jsxDEV(\"li\", {\n                      children: /*#__PURE__*/_jsxDEV(\"a\", {\n                        href: video.url,\n                        target: \"_blank\",\n                        rel: \"noopener noreferrer\",\n                        className: \"text-blue-600 hover:underline\",\n                        children: video.title\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 865,\n                        columnNumber: 37\n                      }, this)\n                    }, idx, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 864,\n                      columnNumber: 35\n                    }, this))\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 862,\n                    columnNumber: 31\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 860,\n                  columnNumber: 29\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 838,\n                columnNumber: 25\n              }, this), msg.hasGraph && msg.graphData && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mt-2\",\n                children: /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: `data:image/png;base64,${msg.graphData}`,\n                  alt: \"Flowchart graph\",\n                  className: \"rounded-md max-w-full h-auto\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 884,\n                  columnNumber: 27\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 883,\n                columnNumber: 25\n              }, this), msg.role === 'assistant' && msg.hasAudio && !msg.ttsUnavailable && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mt-2 flex space-x-2\",\n                children: isPlayingAudio && currentAudioMessage === index ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-xs px-2 py-1 rounded flex items-center bg-intel-dark-blue text-white\",\n                    children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n                      icon: faSpinner,\n                      className: \"mr-1 animate-spin\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 898,\n                      columnNumber: 33\n                    }, this), \"Playing...\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 897,\n                    columnNumber: 31\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: stopAudioPlayback,\n                    className: \"text-xs px-2 py-1 rounded flex items-center bg-red-500 hover:bg-red-600 text-white\",\n                    title: \"Stop playback\",\n                    children: /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n                      icon: faStop\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 909,\n                      columnNumber: 33\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 904,\n                    columnNumber: 31\n                  }, this)]\n                }, void 0, true) : /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => convertTextToSpeech(msg.content, index),\n                  disabled: isPlayingAudio && currentAudioMessage !== index,\n                  className: \"text-xs px-2 py-1 rounded flex items-center bg-gray-100 hover:bg-gray-200 text-gray-700\",\n                  children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n                    icon: faMicrophone,\n                    className: \"mr-1\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 918,\n                    columnNumber: 31\n                  }, this), \"Listen\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 913,\n                  columnNumber: 29\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 894,\n                columnNumber: 25\n              }, this), msg.role === 'assistant' && msg.ttsUnavailable && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mt-2\",\n                children: /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-xs text-gray-500 italic\",\n                  children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n                    icon: faVolumeXmark,\n                    className: \"mr-1\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 928,\n                    columnNumber: 29\n                  }, this), \"Audio unavailable\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 927,\n                  columnNumber: 27\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 926,\n                columnNumber: 25\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 808,\n              columnNumber: 21\n            }, this)\n          }, index, false, {\n            fileName: _jsxFileName,\n            lineNumber: 804,\n            columnNumber: 19\n          }, this)), isLoading && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-start\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-gray-200 text-gray-800 rounded-lg rounded-bl-none p-3 max-w-3/4\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center space-x-1\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"w-2 h-2 bg-gray-600 rounded-full animate-bounce\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 940,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"w-2 h-2 bg-gray-600 rounded-full animate-bounce\",\n                  style: {\n                    animationDelay: '0.2s'\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 941,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"w-2 h-2 bg-gray-600 rounded-full animate-bounce\",\n                  style: {\n                    animationDelay: '0.4s'\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 942,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 939,\n                columnNumber: 23\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 938,\n              columnNumber: 21\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 937,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            ref: messagesEndRef\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 947,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 802,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 795,\n        columnNumber: 11\n      }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-red-100 text-red-800 p-2 text-xs\",\n        children: [error, /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setError(null),\n          className: \"ml-2 text-red-800 hover:text-red-900\",\n          children: \"Dismiss\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 956,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 954,\n        columnNumber: 13\n      }, this), isCameraActive && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative border-t border-gray-200 p-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-black rounded-lg\",\n          style: {\n            minHeight: '200px'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"video\", {\n            ref: videoRef,\n            autoPlay: true,\n            playsInline: true,\n            muted: true,\n            className: \"w-full h-full rounded-lg\",\n            style: {\n              maxHeight: '200px',\n              objectFit: 'contain'\n            },\n            onLoadedData: () => console.log('Video loaded and ready')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 969,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 968,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"absolute top-4 right-4 p-2 bg-blue-600 text-white rounded-full hover:bg-blue-700 focus:outline-none\",\n          onClick: captureImage,\n          children: /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n            icon: faCamera\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 983,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 979,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 967,\n        columnNumber: 13\n      }, this), capturedImage && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative border-t border-gray-200 p-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: capturedImage,\n          alt: \"Captured\",\n          className: \"w-full rounded-lg\",\n          style: {\n            maxHeight: '200px',\n            objectFit: 'contain'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 991,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-center mt-2 space-x-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 focus:outline-none\",\n            onClick: () => setCapturedImage(null),\n            children: \"Cancel\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 998,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 focus:outline-none\",\n            onClick: processImage,\n            disabled: isLoading,\n            children: isLoading ? 'Processing...' : 'Extract Text'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1004,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 997,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 990,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n        ref: canvasRef,\n        className: \"hidden\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1016,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"border-t border-gray-200 p-3 bg-white\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n            value: inputMessage,\n            onChange: e => setInputMessage(e.target.value),\n            onKeyPress: handleKeyPress,\n            placeholder: \"Ask me anything...\",\n            className: \"flex-1 border border-gray-300 rounded-l-lg p-2 focus:outline-none focus:ring-2 focus:ring-intel-blue focus:border-transparent resize-none max-h-20\",\n            rows: \"1\",\n            disabled: isListening\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1021,\n            columnNumber: 15\n          }, this), speechSupported && /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: toggleListening,\n            disabled: isLoading,\n            className: `p-2 ${isListening ? 'bg-red-500 hover:bg-red-600' : 'bg-green-500 hover:bg-green-600'} text-white`,\n            title: isListening ? 'Stop listening' : 'Start voice input',\n            children: isListening ? /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n              icon: faSpinner,\n              spin: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1038,\n              columnNumber: 21\n            }, this) : /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n              icon: faMicrophone\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1040,\n              columnNumber: 21\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1031,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: toggleCamera,\n            disabled: isLoading,\n            className: `p-2 ${isCameraActive ? 'bg-red-500 hover:bg-red-600' : 'bg-blue-500 hover:bg-blue-600'} text-white`,\n            title: isCameraActive ? 'Stop camera' : 'Capture image',\n            children: /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n              icon: faCamera\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1050,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1044,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => sendMessage(),\n            disabled: isLoading || !inputMessage.trim(),\n            className: `bg-intel-blue text-white p-2 rounded-r-lg h-full ${!inputMessage.trim() || isLoading ? 'opacity-50 cursor-not-allowed' : 'hover:bg-intel-dark-blue'}`,\n            children: /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n              icon: faPaperPlane\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1057,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1052,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1020,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-xs text-gray-500 mt-1 text-center\",\n          children: speechSupported ? /*#__PURE__*/_jsxDEV(\"span\", {\n            children: [\"Type or \", isListening ? 'speaking...' : 'click the microphone to speak', \" \\u2022 Powered by Groq LLM API\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1062,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Powered by Groq LLM API\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1064,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1060,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1019,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 769,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 757,\n    columnNumber: 5\n  }, this);\n};\n_s(ChatbotButton, \"Hw/RCpSjg+Z97ikOQmjEDCiQH+A=\");\n_c = ChatbotButton;\nexport default ChatbotButton;\nvar _c;\n$RefreshReg$(_c, \"ChatbotButton\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useNavigate","FontAwesomeIcon","faComments","faRobot","faTimes","faUser","faMicrophone","faCamera","faSpinner","faTrash","faVolumeXmark","faPaperPlane","faStop","faImage","faSearch","faChartSimple","jsxDEV","_jsxDEV","Fragment","_Fragment","ChatbotButton","_s","isOpen","setIsOpen","messages","setMessages","inputMessage","setInputMessage","isLoading","setIsLoading","error","setError","initialized","setInitialized","isListening","setIsListening","speechSupported","setSpeechSupported","isCameraActive","setIsCameraActive","capturedImage","setCapturedImage","isPlayingAudio","setIsPlayingAudio","currentAudioMessage","setCurrentAudioMessage","isGeneratingImage","setIsGeneratingImage","imagePrompt","setImagePrompt","generatedImage","setGeneratedImage","isSearchingContent","setIsSearchingContent","searchTopic","setSearchTopic","searchResults","setSearchResults","isGeneratingGraph","setIsGeneratingGraph","graphTopic","setGraphTopic","generatedGraph","setGeneratedGraph","activeTab","setActiveTab","messagesEndRef","recognitionRef","videoRef","canvasRef","streamRef","getUserId","userId","localStorage","getItem","Math","random","toString","substring","setItem","window","SpeechRecognition","webkitSpeechRecognition","current","continuous","interimResults","onresult","event","transcript","results","sendMessage","onerror","console","onend","navigator","mediaDevices","getUserMedia","log","scrollToBottom","_messagesEndRef$curre","scrollIntoView","behavior","initializeChatbot","response","fetch","method","headers","body","JSON","stringify","user_id","course_context","ok","Error","status","data","json","success","conversation_length","fetchHistory","role","content","message","err","history","toggleListening","stop","start","toggleCamera","getTracks","forEach","track","setTimeout","stream","video","width","ideal","height","srcObject","onloadedmetadata","videoWidth","videoHeight","captureImage","canvas","context","getContext","warn","drawImage","imageDataUrl","toDataURL","length","processImage","image","text","voiceInput","messageToSend","trim","prev","hasAudio","audioData","clearConversation","handleKeyPress","e","key","shiftKey","preventDefault","convertTextToSpeech","messageIndex","playAudio","speakWithBrowserTTS","backendUrl","mode","updatedMessages","audio","ttsUnavailable","audioBase64","Audio","onended","play","catch","stopAudioPlayback","speechSynthesis","cancel","generateImage","prompt","steps","newMessage","hasImage","imageData","searchEducationalContent","topic","images","videos","index","title","hasSearchResults","searchData","generateFlowchartGraph","hasGraph","graphData","utterance","SpeechSynthesisUtterance","lang","rate","pitch","volume","speak","className","children","onClick","icon","size","fileName","_jsxFileName","lineNumber","columnNumber","map","msg","src","alt","slice","imageUrl","idx","onError","target","href","url","rel","disabled","style","animationDelay","ref","minHeight","autoPlay","playsInline","muted","maxHeight","objectFit","onLoadedData","value","onChange","onKeyPress","placeholder","rows","spin","_c","$RefreshReg$"],"sources":["C:/Users/rkgup/OneDrive/Desktop/corementis/frontend/src/components/student/ChatbotButton.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { \n  faComments, \n  faRobot, \n  faTimes, \n  faUser, \n  faMicrophone, \n  faCamera,\n  faSpinner,\n  faTrash,\n  faVolumeXmark,\n  faPaperPlane,\n  faStop,\n  faImage,\n  faSearch,\n  faChartSimple\n} from '@fortawesome/free-solid-svg-icons';\n\nconst ChatbotButton = () => {\n  const [isOpen, setIsOpen] = useState(false);\n  const [messages, setMessages] = useState([]);\n  const [inputMessage, setInputMessage] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [initialized, setInitialized] = useState(false);\n  const [isListening, setIsListening] = useState(false);\n  const [speechSupported, setSpeechSupported] = useState(false);\n  const [isCameraActive, setIsCameraActive] = useState(false);\n  const [capturedImage, setCapturedImage] = useState(null);\n  const [isPlayingAudio, setIsPlayingAudio] = useState(false);\n  const [currentAudioMessage, setCurrentAudioMessage] = useState(null);\n  \n  // New state variables for image generation and web scraping\n  const [isGeneratingImage, setIsGeneratingImage] = useState(false);\n  const [imagePrompt, setImagePrompt] = useState('');\n  const [generatedImage, setGeneratedImage] = useState(null);\n  const [isSearchingContent, setIsSearchingContent] = useState(false);\n  const [searchTopic, setSearchTopic] = useState('');\n  const [searchResults, setSearchResults] = useState(null);\n  const [isGeneratingGraph, setIsGeneratingGraph] = useState(false);\n  const [graphTopic, setGraphTopic] = useState('');\n  const [generatedGraph, setGeneratedGraph] = useState(null);\n  const [activeTab, setActiveTab] = useState('chat'); // 'chat', 'image', 'search', 'graph'\n  \n  const messagesEndRef = useRef(null);\n  const recognitionRef = useRef(null);\n  const videoRef = useRef(null);\n  const canvasRef = useRef(null);\n  const streamRef = useRef(null);\n  \n  // Generate a user ID or get from localStorage\n  const getUserId = () => {\n    let userId = localStorage.getItem('corementis_user_id');\n    if (!userId) {\n      userId = 'user_' + Math.random().toString(36).substring(2, 15);\n      localStorage.setItem('corementis_user_id', userId);\n    }\n    return userId;\n  };\n  \n  // Initialize speech recognition\n  useEffect(() => {\n    // Initialize Web Speech API\n    if (window.SpeechRecognition || window.webkitSpeechRecognition) {\n      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;\n      recognitionRef.current = new SpeechRecognition();\n      recognitionRef.current.continuous = false;\n      recognitionRef.current.interimResults = false;\n      \n      recognitionRef.current.onresult = (event) => {\n        const transcript = event.results[0][0].transcript;\n        setInputMessage(transcript);\n        sendMessage(transcript);\n      };\n      \n      recognitionRef.current.onerror = (event) => {\n        console.error('Speech recognition error', event.error);\n        setError(`Speech recognition error: ${event.error}`);\n        setIsListening(false);\n      };\n      \n      recognitionRef.current.onend = () => {\n        setIsListening(false);\n      };\n      \n      setSpeechSupported(true);\n    }\n    \n    // Check camera capabilities\n    if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n      console.log('Camera API is supported');\n    } else {\n      console.error('Camera API is not supported in this browser');\n      setError('Camera is not supported in your browser');\n    }\n  }, []);\n  \n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n  \n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n  \n  // Initialize chatbot when first opened\n  useEffect(() => {\n    if (isOpen && !initialized) {\n      initializeChatbot();\n    }\n  }, [isOpen, initialized]);\n  \n  const initializeChatbot = async () => {\n    try {\n      setIsLoading(true);\n      console.log('Initializing chatbot...');\n      const response = await fetch('http://localhost:5001/api/chatbot/initialize', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          user_id: getUserId(),\n          course_context: 'Computer Vision and Machine Learning'\n        }),\n      });\n      \n      if (!response.ok) {\n        throw new Error(`Server responded with status: ${response.status}`);\n      }\n      \n      const data = await response.json();\n      \n      if (data.success) {\n        setInitialized(true);\n        // If there's existing conversation, fetch it\n        if (data.conversation_length > 1) {\n          fetchHistory();\n        } else {\n          // Add welcome message\n          setMessages([\n            {\n              role: 'assistant',\n              content: 'Hello! I\\'m your CoreMentis AI assistant. How can I help you with your studies today?'\n            }\n          ]);\n        }\n      } else {\n        setError('Failed to initialize chatbot: ' + data.message);\n      }\n    } catch (err) {\n      setError('Error connecting to chatbot service: ' + err.message);\n      console.error('Error initializing chatbot:', err);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  \n  const fetchHistory = async () => {\n    try {\n      const response = await fetch(`http://localhost:5001/api/chatbot/history?user_id=${getUserId()}`);\n      const data = await response.json();\n      \n      if (data.success) {\n        setMessages(data.history);\n      }\n    } catch (err) {\n      console.error('Error fetching chat history:', err);\n    }\n  };\n  \n  const toggleListening = () => {\n    if (!speechSupported) {\n      setError('Speech recognition is not supported in your browser.');\n      return;\n    }\n    \n    if (isListening) {\n      recognitionRef.current.stop();\n      setIsListening(false);\n    } else {\n      setError(null);\n      recognitionRef.current.start();\n      setIsListening(true);\n    }\n  };\n  \n  const toggleCamera = async () => {\n    console.log('Toggle camera called, current state:', isCameraActive);\n    \n    if (isCameraActive) {\n      // Stop the camera\n      if (streamRef.current) {\n        streamRef.current.getTracks().forEach(track => track.stop());\n        streamRef.current = null;\n      }\n      setIsCameraActive(false);\n      setCapturedImage(null);\n      console.log('Camera deactivated');\n    } else {\n      try {\n        // First set camera active to render the video element\n        setIsCameraActive(true);\n        \n        // Wait for the video element to be rendered\n        setTimeout(async () => {\n          try {\n            // Start the camera\n            setError(null);\n            console.log('Requesting camera access...');\n            const stream = await navigator.mediaDevices.getUserMedia({ \n              video: { \n                width: { ideal: 1280 },\n                height: { ideal: 720 }\n              } \n            });\n            \n            console.log('Camera access granted, setting up video stream');\n            streamRef.current = stream;\n            \n            if (videoRef.current) {\n              console.log('Video ref exists, setting srcObject');\n              videoRef.current.srcObject = stream;\n              videoRef.current.onloadedmetadata = () => {\n                console.log('Video metadata loaded, dimensions:', \n                  videoRef.current.videoWidth, 'x', videoRef.current.videoHeight);\n              };\n            } else {\n              console.error('Video ref does not exist');\n              setError('Video element not found');\n              setIsCameraActive(false);\n            }\n          } catch (err) {\n            setError('Error accessing camera: ' + err.message);\n            console.error('Error accessing camera:', err);\n            setIsCameraActive(false);\n          }\n        }, 500); // Wait 500ms for the video element to be rendered\n      } catch (err) {\n        setError('Error setting up camera: ' + err.message);\n        console.error('Error setting up camera:', err);\n        setIsCameraActive(false);\n      }\n    }\n  };\n  \n  const captureImage = () => {\n    if (!isCameraActive || !videoRef.current || !canvasRef.current) {\n      console.error('Cannot capture image: camera not active or refs not available');\n      return;\n    }\n    \n    try {\n      const video = videoRef.current;\n      const canvas = canvasRef.current;\n      const context = canvas.getContext('2d');\n      \n      console.log('Video dimensions:', video.videoWidth, video.videoHeight);\n      \n      // Set canvas dimensions to match video\n      canvas.width = video.videoWidth || 640;\n      canvas.height = video.videoHeight || 480;\n      \n      if (video.videoWidth === 0 || video.videoHeight === 0) {\n        console.warn('Video dimensions are zero, using fallback dimensions');\n      }\n      \n      // Draw the current video frame to the canvas\n      context.drawImage(video, 0, 0, canvas.width, canvas.height);\n      \n      // Get the image as a data URL\n      const imageDataUrl = canvas.toDataURL('image/jpeg', 0.9);\n      console.log('Image captured, data URL length:', imageDataUrl.length);\n      setCapturedImage(imageDataUrl);\n      \n      // Stop the camera\n      if (streamRef.current) {\n        streamRef.current.getTracks().forEach(track => track.stop());\n        streamRef.current = null;\n      }\n      setIsCameraActive(false);\n    } catch (err) {\n      console.error('Error capturing image:', err);\n      setError('Error capturing image: ' + err.message);\n    }\n  };\n  \n  const processImage = async () => {\n    if (!capturedImage) return;\n    \n    try {\n      setIsLoading(true);\n      setError(null);\n      \n      // Send the image to the backend for OCR\n      const response = await fetch('http://localhost:5001/api/chatbot/image-to-text', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          image: capturedImage\n        }),\n      });\n      \n      const data = await response.json();\n      \n      if (data.success) {\n        // Set the extracted text in the input field\n        setInputMessage(data.text);\n        \n        // Auto-send the extracted text\n        sendMessage(data.text);\n      } else {\n        setError('Failed to extract text from image: ' + data.message);\n      }\n    } catch (err) {\n      setError('Error processing image: ' + err.message);\n      console.error('Error processing image:', err);\n    } finally {\n      setIsLoading(false);\n      setCapturedImage(null);\n    }\n  };\n  \n  const sendMessage = async (voiceInput) => {\n    const messageToSend = voiceInput || inputMessage.trim();\n    if (!messageToSend) return;\n    \n    if (!voiceInput) {\n      setInputMessage('');\n    }\n    \n    // Add user message to UI immediately\n    setMessages(prev => [...prev, { role: 'user', content: messageToSend }]);\n    \n    try {\n      setIsLoading(true);\n      const response = await fetch('http://localhost:5001/api/chatbot/message', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          user_id: getUserId(),\n          message: messageToSend\n        }),\n      });\n      \n      const data = await response.json();\n      \n      if (data.success) {\n        // Add the response to messages with audio capability\n        setMessages(prev => [...prev, { \n          role: 'assistant', \n          content: data.response,\n          hasAudio: true, // Flag to indicate this message can be converted to speech\n          audioData: null // Will store audio data once generated\n        }]);\n      } else {\n        setError('Failed to get response: ' + data.message);\n        setMessages(prev => [...prev, { role: 'assistant', content: 'Sorry, I encountered an error. Please try again later.' }]);\n      }\n    } catch (err) {\n      setError('Error sending message: ' + err.message);\n      console.error('Error sending message:', err);\n      setMessages(prev => [...prev, { role: 'assistant', content: 'Sorry, I encountered an error. Please try again later.' }]);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  \n  const clearConversation = async () => {\n    try {\n      const response = await fetch('http://localhost:5001/api/chatbot/clear', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          user_id: getUserId(),\n          course_context: 'Computer Vision and Machine Learning'\n        }),\n      });\n      \n      const data = await response.json();\n      \n      if (data.success) {\n        setMessages([\n          {\n            role: 'assistant',\n            content: 'Conversation history cleared. How can I help you today?'\n          }\n        ]);\n      } else {\n        setError('Failed to clear conversation: ' + data.message);\n      }\n    } catch (err) {\n      setError('Error clearing conversation: ' + err.message);\n      console.error('Error clearing conversation:', err);\n    }\n  };\n  \n  const handleKeyPress = (e) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      sendMessage();\n    }\n  };\n  \n  const convertTextToSpeech = async (text, messageIndex) => {\n    try {\n      setIsPlayingAudio(true);\n      setCurrentAudioMessage(messageIndex);\n      setError(null);\n      \n      // Check if we already have audio data for this message\n      if (messages[messageIndex].audioData) {\n        playAudio(messages[messageIndex].audioData);\n        return;\n      }\n      \n      // First try to use the browser's built-in speech synthesis\n      if ('speechSynthesis' in window) {\n        console.log('Using browser speech synthesis');\n        speakWithBrowserTTS(text);\n        return;\n      }\n      \n      // Fallback to backend TTS if browser TTS is not available\n      // Use the same origin as the current page to avoid CORS issues\n      const backendUrl = 'http://localhost:5001';\n      \n      console.log('Using backend TTS service:', `${backendUrl}/api/chatbot/text-to-speech`);\n      \n      const response = await fetch(`${backendUrl}/api/chatbot/text-to-speech`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          user_id: getUserId(),\n          text: text\n        }),\n        // Simplify CORS settings\n        mode: 'cors'\n      });\n      \n      if (!response.ok) {\n        // Handle HTTP error status codes (like 503 Service Unavailable)\n        if (response.status === 503) {\n          throw new Error('Text-to-speech service is not available on this server');\n        } else {\n          throw new Error(`Server error: ${response.status}`);\n        }\n      }\n      \n      const data = await response.json();\n      \n      if (data.success) {\n        // Store the audio data in the message\n        const updatedMessages = [...messages];\n        updatedMessages[messageIndex].audioData = data.audio;\n        setMessages(updatedMessages);\n        \n        // Play the audio\n        playAudio(data.audio);\n      } else {\n        // Handle application-level errors\n        setError('Failed to convert text to speech: ' + (data.message || 'Unknown error'));\n        setIsPlayingAudio(false);\n        setCurrentAudioMessage(null);\n      }\n    } catch (err) {\n      // Handle network errors and other exceptions\n      setError('Error: ' + (err.message || 'Failed to connect to text-to-speech service'));\n      console.error('Error converting text to speech:', err);\n      setIsPlayingAudio(false);\n      setCurrentAudioMessage(null);\n      \n      // Update the message to indicate TTS is not available\n      const updatedMessages = [...messages];\n      updatedMessages[messageIndex].ttsUnavailable = true;\n      setMessages(updatedMessages);\n    }\n  };\n  \n  const playAudio = (audioBase64) => {\n    const audio = new Audio(`data:audio/wav;base64,${audioBase64}`);\n    \n    audio.onended = () => {\n      setIsPlayingAudio(false);\n      setCurrentAudioMessage(null);\n    };\n    \n    audio.onerror = (e) => {\n      console.error('Error playing audio:', e);\n      setError('Error playing audio');\n      setIsPlayingAudio(false);\n      setCurrentAudioMessage(null);\n    };\n    \n    audio.play().catch(e => {\n      console.error('Error playing audio:', e);\n      setError('Error playing audio: ' + e.message);\n      setIsPlayingAudio(false);\n      setCurrentAudioMessage(null);\n    });\n  };\n  \n  // Stop audio playback\n  const stopAudioPlayback = () => {\n    // Cancel any ongoing speech synthesis\n    if ('speechSynthesis' in window) {\n      window.speechSynthesis.cancel();\n    }\n    \n    // Reset audio state\n    setIsPlayingAudio(false);\n    setCurrentAudioMessage(null);\n    console.log('Audio playback stopped');\n  };\n  \n  // Generate image from text prompt\n  const generateImage = async (prompt) => {\n    try {\n      setIsGeneratingImage(true);\n      setError(null);\n      \n      // Use the same origin as the current page to avoid CORS issues\n      const backendUrl = 'http://localhost:5001';\n      \n      console.log('Generating image for prompt:', prompt);\n      \n      const response = await fetch(`${backendUrl}/api/chatbot/text-to-image`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          user_id: getUserId(),\n          prompt: prompt,\n          width: 512,\n          height: 512,\n          steps: 10\n        }),\n        mode: 'cors'\n      });\n      \n      if (!response.ok) {\n        if (response.status === 503) {\n          throw new Error('Image generation service is not available on this server');\n        } else {\n          throw new Error(`Server error: ${response.status}`);\n        }\n      }\n      \n      const data = await response.json();\n      \n      if (data.success) {\n        setGeneratedImage(data.image);\n        \n        // Add the generated image to the conversation\n        const newMessage = {\n          role: 'assistant',\n          content: `I've generated an image based on your prompt: \"${prompt}\"`,\n          hasImage: true,\n          imageData: data.image\n        };\n        \n        setMessages([...messages, newMessage]);\n      } else {\n        throw new Error(data.message || 'Failed to generate image');\n      }\n    } catch (err) {\n      setError('Error: ' + (err.message || 'Failed to generate image'));\n      console.error('Error generating image:', err);\n    } finally {\n      setIsGeneratingImage(false);\n      setImagePrompt('');\n    }\n  };\n  \n  // Search for educational content\n  const searchEducationalContent = async (topic) => {\n    try {\n      setIsSearchingContent(true);\n      setError(null);\n      \n      // Use the same origin as the current page to avoid CORS issues\n      const backendUrl = 'http://localhost:5001';\n      \n      console.log('Searching educational content for topic:', topic);\n      \n      const response = await fetch(`${backendUrl}/api/chatbot/search-content`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          user_id: getUserId(),\n          topic: topic\n        }),\n        mode: 'cors'\n      });\n      \n      if (!response.ok) {\n        if (response.status === 503) {\n          throw new Error('Content search service is not available on this server');\n        } else {\n          throw new Error(`Server error: ${response.status}`);\n        }\n      }\n      \n      const data = await response.json();\n      \n      if (data.success) {\n        setSearchResults(data);\n        \n        // Add the search results to the conversation\n        let content = `Here are some educational resources about \"${topic}\":\\n\\n`;\n        \n        if (data.images && data.images.length > 0) {\n          content += `📸 ${data.images.length} relevant images found\\n`;\n        } else {\n          content += \"No relevant images found\\n\";\n        }\n        \n        if (data.videos && data.videos.length > 0) {\n          content += `🎬 ${data.videos.length} educational videos found:\\n`;\n          data.videos.forEach((video, index) => {\n            content += `${index + 1}. ${video.title}\\n`;\n          });\n        } else {\n          content += \"No educational videos found\";\n        }\n        \n        const newMessage = {\n          role: 'assistant',\n          content: content,\n          hasSearchResults: true,\n          searchData: data\n        };\n        \n        setMessages([...messages, newMessage]);\n      } else {\n        throw new Error(data.message || 'Failed to search educational content');\n      }\n    } catch (err) {\n      setError('Error: ' + (err.message || 'Failed to search educational content'));\n      console.error('Error searching educational content:', err);\n    } finally {\n      setIsSearchingContent(false);\n      setSearchTopic('');\n    }\n  };\n  \n  // Generate flowchart graph\n  const generateFlowchartGraph = async (topic) => {\n    try {\n      setIsGeneratingGraph(true);\n      setError(null);\n      \n      // Use the same origin as the current page to avoid CORS issues\n      const backendUrl = 'http://localhost:5001';\n      \n      console.log('Generating flowchart for topic:', topic);\n      \n      const response = await fetch(`${backendUrl}/api/chatbot/generate-graph`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          user_id: getUserId(),\n          topic: topic\n        }),\n        mode: 'cors'\n      });\n      \n      if (!response.ok) {\n        if (response.status === 503) {\n          throw new Error('Graph generation service is not available on this server');\n        } else {\n          throw new Error(`Server error: ${response.status}`);\n        }\n      }\n      \n      const data = await response.json();\n      \n      if (data.success) {\n        setGeneratedGraph(data);\n        \n        // Add the generated graph to the conversation\n        const newMessage = {\n          role: 'assistant',\n          content: `I've created a flowchart for \"${topic}\":\\n\\n${data.text}`,\n          hasGraph: true,\n          graphData: data.image\n        };\n        \n        setMessages([...messages, newMessage]);\n      } else {\n        throw new Error(data.message || 'Failed to generate flowchart');\n      }\n    } catch (err) {\n      setError('Error: ' + (err.message || 'Failed to generate flowchart'));\n      console.error('Error generating flowchart:', err);\n    } finally {\n      setIsGeneratingGraph(false);\n      setGraphTopic('');\n    }\n  };\n  \n  // Use browser's built-in speech synthesis\n  const speakWithBrowserTTS = (text) => {\n    if (!('speechSynthesis' in window)) {\n      setError('Browser speech synthesis not supported');\n      setIsPlayingAudio(false);\n      setCurrentAudioMessage(null);\n      return;\n    }\n    \n    // Cancel any ongoing speech\n    window.speechSynthesis.cancel();\n    \n    const utterance = new SpeechSynthesisUtterance(text);\n    \n    // Set properties\n    utterance.lang = 'en-US';\n    utterance.rate = 1.0;\n    utterance.pitch = 1.0;\n    utterance.volume = 1.0;\n    \n    // Event handlers\n    utterance.onend = () => {\n      console.log('Browser TTS finished');\n      setIsPlayingAudio(false);\n      setCurrentAudioMessage(null);\n    };\n    \n    utterance.onerror = (event) => {\n      console.error('Browser TTS error:', event);\n      setError('Error with speech synthesis: ' + event.error);\n      setIsPlayingAudio(false);\n      setCurrentAudioMessage(null);\n    };\n    \n    // Start speaking\n    window.speechSynthesis.speak(utterance);\n    console.log('Browser TTS started');\n  };\n  \n  return (\n    <div className=\"fixed bottom-6 right-6 z-50\">\n      {/* Chatbot Button */}\n      <button\n        onClick={() => setIsOpen(!isOpen)}\n        className=\"bg-intel-blue hover:bg-intel-dark-blue text-white rounded-full w-14 h-14 flex items-center justify-center shadow-lg transition-all duration-300 hover:scale-110\"\n        aria-label=\"Open AI Assistant\"\n      >\n        <FontAwesomeIcon icon={faComments} size=\"lg\" />\n      </button>\n      \n      {/* Chatbot Panel */}\n      {isOpen && (\n        <div className=\"absolute bottom-20 right-0 w-80 sm:w-96 bg-white rounded-lg shadow-xl overflow-hidden flex flex-col border border-gray-200\">\n          {/* Header */}\n          <div className=\"bg-intel-blue text-white p-4 flex justify-between items-center\">\n            <div className=\"flex items-center\">\n              <FontAwesomeIcon icon={faRobot} className=\"mr-2\" />\n              <h3 className=\"font-medium\">CoreMentis AI Assistant</h3>\n            </div>\n            <div className=\"flex space-x-2\">\n              <button \n                onClick={clearConversation}\n                className=\"text-white hover:text-gray-200 transition-colors\"\n                title=\"Clear conversation\"\n              >\n                <FontAwesomeIcon icon={faTrash} />\n              </button>\n              <button \n                onClick={() => setIsOpen(false)}\n                className=\"text-white hover:text-gray-200 transition-colors\"\n                title=\"Close chatbot\"\n              >\n                <FontAwesomeIcon icon={faTimes} />\n              </button>\n            </div>\n          </div>\n          \n          {/* Messages Container */}\n          <div className=\"flex-1 p-4 overflow-y-auto max-h-96 bg-gray-50\">\n            {messages.length === 0 && !isLoading ? (\n              <div className=\"text-center text-gray-500 py-8\">\n                <FontAwesomeIcon icon={faRobot} size=\"2x\" className=\"mb-2 text-intel-blue\" />\n                <p>Start a conversation with the AI assistant</p>\n              </div>\n            ) : (\n              <div className=\"space-y-4\">\n                {messages.map((msg, index) => (\n                  <div \n                    key={index} \n                    className={`flex ${msg.role === 'user' ? 'justify-end' : 'justify-start'}`}\n                  >\n                    <div \n                      className={`max-w-3/4 rounded-lg p-3 ${msg.role === 'user' \n                        ? 'bg-intel-blue text-white rounded-br-none' \n                        : 'bg-gray-200 text-gray-800 rounded-bl-none'}`}\n                    >\n                      <div className=\"flex items-center mb-1\">\n                        <FontAwesomeIcon \n                          icon={msg.role === 'user' ? faUser : faRobot} \n                          className=\"mr-2\" \n                          size=\"xs\"\n                        />\n                        <span className=\"text-xs font-semibold\">\n                          {msg.role === 'user' ? 'You' : 'AI Assistant'}\n                        </span>\n                      </div>\n                      <p className=\"whitespace-pre-wrap text-sm\">{msg.content}</p>\n                      \n                      {/* Display generated image if present */}\n                      {msg.hasImage && msg.imageData && (\n                        <div className=\"mt-2\">\n                          <img \n                            src={`data:image/png;base64,${msg.imageData}`} \n                            alt=\"Generated image\"\n                            className=\"rounded-md max-w-full h-auto\"\n                          />\n                        </div>\n                      )}\n                      \n                      {/* Display search results if present */}\n                      {msg.hasSearchResults && msg.searchData && (\n                        <div className=\"mt-2\">\n                          {msg.searchData.images && msg.searchData.images.length > 0 && (\n                            <div className=\"mb-2\">\n                              <p className=\"text-xs font-semibold mb-1\">Images:</p>\n                              <div className=\"flex flex-wrap gap-1\">\n                                {msg.searchData.images.slice(0, 3).map((imageUrl, idx) => (\n                                  <img \n                                    key={idx}\n                                    src={imageUrl}\n                                    alt={`Search result ${idx + 1}`}\n                                    className=\"w-24 h-24 object-cover rounded-md\"\n                                    onError={(e) => {\n                                      e.target.onerror = null;\n                                      e.target.src = 'https://via.placeholder.com/100x100?text=Image+Error';\n                                    }}\n                                  />\n                                ))}\n                              </div>\n                            </div>\n                          )}\n                          \n                          {msg.searchData.videos && msg.searchData.videos.length > 0 && (\n                            <div>\n                              <p className=\"text-xs font-semibold mb-1\">Videos:</p>\n                              <ul className=\"text-xs list-disc pl-4\">\n                                {msg.searchData.videos.slice(0, 3).map((video, idx) => (\n                                  <li key={idx}>\n                                    <a \n                                      href={video.url} \n                                      target=\"_blank\" \n                                      rel=\"noopener noreferrer\"\n                                      className=\"text-blue-600 hover:underline\"\n                                    >\n                                      {video.title}\n                                    </a>\n                                  </li>\n                                ))}\n                              </ul>\n                            </div>\n                          )}\n                        </div>\n                      )}\n                      \n                      {/* Display generated graph if present */}\n                      {msg.hasGraph && msg.graphData && (\n                        <div className=\"mt-2\">\n                          <img \n                            src={`data:image/png;base64,${msg.graphData}`} \n                            alt=\"Flowchart graph\"\n                            className=\"rounded-md max-w-full h-auto\"\n                          />\n                        </div>\n                      )}\n                      \n                      {/* Audio playback button for assistant messages */}\n                      {msg.role === 'assistant' && msg.hasAudio && !msg.ttsUnavailable && (\n                        <div className=\"mt-2 flex space-x-2\">\n                          {isPlayingAudio && currentAudioMessage === index ? (\n                            <>\n                              <div className=\"text-xs px-2 py-1 rounded flex items-center bg-intel-dark-blue text-white\">\n                                <FontAwesomeIcon \n                                  icon={faSpinner}\n                                  className=\"mr-1 animate-spin\" \n                                />\n                                Playing...\n                              </div>\n                              <button\n                                onClick={stopAudioPlayback}\n                                className=\"text-xs px-2 py-1 rounded flex items-center bg-red-500 hover:bg-red-600 text-white\"\n                                title=\"Stop playback\"\n                              >\n                                <FontAwesomeIcon icon={faStop} />\n                              </button>\n                            </>\n                          ) : (\n                            <button\n                              onClick={() => convertTextToSpeech(msg.content, index)}\n                              disabled={isPlayingAudio && currentAudioMessage !== index}\n                              className=\"text-xs px-2 py-1 rounded flex items-center bg-gray-100 hover:bg-gray-200 text-gray-700\"\n                            >\n                              <FontAwesomeIcon icon={faMicrophone} className=\"mr-1\" />\n                              Listen\n                            </button>\n                          )}\n                        </div>\n                      )}\n                      {/* Message for when TTS is unavailable */}\n                      {msg.role === 'assistant' && msg.ttsUnavailable && (\n                        <div className=\"mt-2\">\n                          <span className=\"text-xs text-gray-500 italic\">\n                            <FontAwesomeIcon icon={faVolumeXmark} className=\"mr-1\" />\n                            Audio unavailable\n                          </span>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                ))}\n                {isLoading && (\n                  <div className=\"flex justify-start\">\n                    <div className=\"bg-gray-200 text-gray-800 rounded-lg rounded-bl-none p-3 max-w-3/4\">\n                      <div className=\"flex items-center space-x-1\">\n                        <div className=\"w-2 h-2 bg-gray-600 rounded-full animate-bounce\"></div>\n                        <div className=\"w-2 h-2 bg-gray-600 rounded-full animate-bounce\" style={{ animationDelay: '0.2s' }}></div>\n                        <div className=\"w-2 h-2 bg-gray-600 rounded-full animate-bounce\" style={{ animationDelay: '0.4s' }}></div>\n                      </div>\n                    </div>\n                  </div>\n                )}\n                <div ref={messagesEndRef} />\n              </div>\n            )}\n          </div>\n          \n          {/* Error Message */}\n          {error && (\n            <div className=\"bg-red-100 text-red-800 p-2 text-xs\">\n              {error}\n              <button \n                onClick={() => setError(null)} \n                className=\"ml-2 text-red-800 hover:text-red-900\"\n              >\n                Dismiss\n              </button>\n            </div>\n          )}\n          \n          {/* Camera view */}\n          {isCameraActive && (\n            <div className=\"relative border-t border-gray-200 p-2\">\n              <div className=\"bg-black rounded-lg\" style={{ minHeight: '200px' }}>\n                <video\n                  ref={videoRef}\n                  autoPlay\n                  playsInline\n                  muted\n                  className=\"w-full h-full rounded-lg\"\n                  style={{ maxHeight: '200px', objectFit: 'contain' }}\n                  onLoadedData={() => console.log('Video loaded and ready')}\n                />\n              </div>\n              <button\n                className=\"absolute top-4 right-4 p-2 bg-blue-600 text-white rounded-full hover:bg-blue-700 focus:outline-none\"\n                onClick={captureImage}\n              >\n                <FontAwesomeIcon icon={faCamera} />\n              </button>\n            </div>\n          )}\n          \n          {/* Captured image */}\n          {capturedImage && (\n            <div className=\"relative border-t border-gray-200 p-2\">\n              <img\n                src={capturedImage}\n                alt=\"Captured\"\n                className=\"w-full rounded-lg\"\n                style={{ maxHeight: '200px', objectFit: 'contain' }}\n              />\n              <div className=\"flex justify-center mt-2 space-x-2\">\n                <button\n                  className=\"px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 focus:outline-none\"\n                  onClick={() => setCapturedImage(null)}\n                >\n                  Cancel\n                </button>\n                <button\n                  className=\"px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 focus:outline-none\"\n                  onClick={processImage}\n                  disabled={isLoading}\n                >\n                  {isLoading ? 'Processing...' : 'Extract Text'}\n                </button>\n              </div>\n            </div>\n          )}\n          \n          {/* Hidden canvas for image capture */}\n          <canvas ref={canvasRef} className=\"hidden\" />\n          \n          {/* Input Area */}\n          <div className=\"border-t border-gray-200 p-3 bg-white\">\n            <div className=\"flex items-center\">\n              <textarea\n                value={inputMessage}\n                onChange={(e) => setInputMessage(e.target.value)}\n                onKeyPress={handleKeyPress}\n                placeholder=\"Ask me anything...\"\n                className=\"flex-1 border border-gray-300 rounded-l-lg p-2 focus:outline-none focus:ring-2 focus:ring-intel-blue focus:border-transparent resize-none max-h-20\"\n                rows=\"1\"\n                disabled={isListening}\n              />\n              {speechSupported && (\n                <button\n                  onClick={toggleListening}\n                  disabled={isLoading}\n                  className={`p-2 ${isListening ? 'bg-red-500 hover:bg-red-600' : 'bg-green-500 hover:bg-green-600'} text-white`}\n                  title={isListening ? 'Stop listening' : 'Start voice input'}\n                >\n                  {isListening ? (\n                    <FontAwesomeIcon icon={faSpinner} spin />\n                  ) : (\n                    <FontAwesomeIcon icon={faMicrophone} />\n                  )}\n                </button>\n              )}\n              <button\n                onClick={toggleCamera}\n                disabled={isLoading}\n                className={`p-2 ${isCameraActive ? 'bg-red-500 hover:bg-red-600' : 'bg-blue-500 hover:bg-blue-600'} text-white`}\n                title={isCameraActive ? 'Stop camera' : 'Capture image'}\n              >\n                <FontAwesomeIcon icon={faCamera} />\n              </button>\n              <button\n                onClick={() => sendMessage()}\n                disabled={isLoading || !inputMessage.trim()}\n                className={`bg-intel-blue text-white p-2 rounded-r-lg h-full ${(!inputMessage.trim() || isLoading) ? 'opacity-50 cursor-not-allowed' : 'hover:bg-intel-dark-blue'}`}\n              >\n                <FontAwesomeIcon icon={faPaperPlane} />\n              </button>\n            </div>\n            <div className=\"text-xs text-gray-500 mt-1 text-center\">\n              {speechSupported ? (\n                <span>Type or {isListening ? 'speaking...' : 'click the microphone to speak'} • Powered by Groq LLM API</span>\n              ) : (\n                <span>Powered by Groq LLM API</span>\n              )}\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default ChatbotButton;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}